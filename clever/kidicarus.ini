RAM $12 PlayerY
RAM $13 PlayerX
RAM $720 PlayerY_2
RAM $723 PlayerX_2
RAM $16 Ctrl1poll
RAM $17 Ctrl1poll2
RAM $1C PlayerXspeed
RAM $1D PlayerYspeed
RAM $A2 Player_InvulnerableFlag

CertainlyCode $1EB21 UpdateRandomSeed
Comment       $1EB21 "RandomSeed <- 35 + 64*carry + (RandomSeed >> 2)"
RAM $26 RandomSeed

CertainlyCode $1225F UpdateRandomWord
Comment       $1225F "RandomWord <- (RandomWord >> 1) | (((RandomWord ^ (RandomWord>>8))&2) << 14)"
Comment       $1225F "Essentially a 16-bit LFSR with taps in bits 1 and 9."
RAM $EF RandomWord_hi
RAM $F0 RandomWord_lo

CertainlyCdoe $1EB21 UpdateRandom
RAM $6B BossHP
RAM $6F Flag_EggplantCurse
RAM $3C Flag_UsingMallet
RAM $A0 GameState
# 0=Title 1=Menu 2=Scrolling 3==abyrinth 8=Equip final items
RAM $A5 ActivatedWeaponsMask
RAM $A7 Timeout_AngelFeather
RAM $3E Timeout_Harp
RAM $728 Timeout_Invulnerability
RAM $A6 PlayerHP
RAM $AA PlayerLevel
RAM $FE ScreenScroll_Lo
RAM $FB ScreenScrollX_Hi
RAM $1A ScreenScrollY_Hi


RAM $BB CodeBufferIndirectJump
RAM $BC CodePointerLo
RAM $BD CodePointerHi_always80
CertainlyCode $1CA90 Bank6JSR
JumpTable $18000 $18001 2 20

RAM $128 calctemp_byte0
RAM $129 calctemp_byte1
RAM $12A calctemp_byte2

RAM $12F CurrentWorld
RAM $130 CurrentStage
RAM $131 CurScore_byte0
RAM $132 CurScore_byte1
RAM $133 CurScore_byte2
RAM $134 AmountOfFavor_byte0
RAM $135 AmountOfFavor_byte1
RAM $136 AmountOfFavor_byte2
RAM $137 GodVisited
RAM $138 CurrentWorldDisplay
RAM $139 CurrentStageDisplay
RAM $13A Flag_Torch
RAM $13B Flag_Pencil
RAM $13D Flag_Checkbook
RAM $13E Flag_FireballPowerup
RAM $13F Flag_BowPowerup
RAM $140 Flag_CrystalPowerup
RAM $141 Weapon0_index
RAM $142 Weapon1_index
RAM $143 Weapon2_index
RAM $144 TotalScore_byte0
RAM $145 TotalScore_byte1
RAM $146 TotalScore_byte2
RAM $602A SecondQuestFlag

RAM $14A Hearts_byte0
RAM $14B Hearts_byte1
RAM $14C CreditDebt_byte0
RAM $14D CreditDebt_byte1
RAM $14E Flag_CreditCard
RAM $14F SledgeHammers
RAM $150 AngelFeathers
RAM $151 BottlesBarrels
RAM $152 PlayerStrengthColor
RAM $153 Flag_Treasure1
RAM $154 Flag_Treasure2
RAM $155 Flag_Treasure3       
RAM $156 CenturionHelpers

DataTable $10056 $10057 2 2

CertainlyData $1E5F2 StatusScreenSpriteData_ArrowSymbolsForStrength 4
CertainlyData $1E5E2 StatusScreenSpriteData_BarrelSprites 4
CertainlyCode $1E44D StatusScreen_DrawBarrel
CertainlyCode $1E483 StatusScreen_DrawPowerups
CertainlyCode $1E47D StatusScreen_DrawPowerups_
CertainlyCode $1E568 StatusScreen_DrawTreasures
CertainlyCode $1E462 StatusScreen_DrawArrowSymbols

RAM $390 PaletteBG_0_0
RAM $391 PaletteBG_0_1
RAM $392 PaletteBG_0_2
RAM $393 PaletteBG_0_3
RAM $394 PaletteBG_1_0
RAM $395 PaletteBG_1_1
RAM $396 PaletteBG_1_2
RAM $397 PaletteBG_1_3
RAM $398 PaletteBG_2_0
RAM $399 PaletteBG_2_1
RAM $39A PaletteBG_2_2
RAM $39B PaletteBG_2_3
RAM $39C PaletteBG_3_0
RAM $39D PaletteBG_3_1
RAM $39E PaletteBG_3_2
RAM $39F PaletteBG_3_3
RAM $3A0 PaletteSPR_0_0
RAM $3A1 PaletteSPR_0_1
RAM $3A2 PaletteSPR_0_2
RAM $3A3 PaletteSPR_0_3
RAM $3A4 PaletteSPR_1_0
RAM $3A5 PaletteSPR_1_1
RAM $3A6 PaletteSPR_1_2
RAM $3A7 PaletteSPR_1_3
RAM $3A8 PaletteSPR_2_0
RAM $3A9 PaletteSPR_2_1
RAM $3AA PaletteSPR_2_2
RAM $3AB PaletteSPR_2_3
RAM $3AC PaletteSPR_3_0
RAM $3AD PaletteSPR_3_1
RAM $3AE PaletteSPR_3_2
RAM $3AF PaletteSPR_3_3
CertainlyData $1C409 PitColorPalettes_1
CertainlyData $1C40A PitColorPalettes_3
CertainlyCode       $1C878
CertainlyCode       $1C17F SwitchBank
MapperChangeRoutine $1C17F reg A
CertainlyCode $1C339 NMIroutine_1C339
RAM $6FFA NMIroutinePtrLo
RAM $6FFB NMIroutinePtrHi
RAM $B6 CurrentBank
CertainlyCode $1C23D ZeroFillRAM_numberOfBytes_in_A

CertainlyData $1C1A8 GameState0_entry
CertainlyData $1C1AB GameState1_entry
CertainlyData $1C1AE GameState2_entry
CertainlyData $1C1B1 GameState3_entry
CertainlyData $1C1B4 GameState4_entry
CertainlyData $1C1B7 GameState5_entry
CertainlyData $1C1BA GameState6_entry
CertainlyData $1C1BD GameState7_entry
CertainlyData $1C1C0 GameState8_entry
CertainlyData $1C1C3 GameState9_entry
CertainlyData $1C152 GameState_MapperInfo
DataTable $1C15C $1C15D 2 10 GameStateTable

CertainlyCode  $6000 RAMcode6000_GameStates01
CertainlyCode  $8000 RAMcode8000_GameState2_World1
CertainlyCode $14000 RAMcode14000_GameStates357_Castle
CertainlyCode  $99A0 RAMcode99A0_GameState4_World2
CertainlyCode  $C000 RAMcodeC000_GameState6_World3
CertainlyCode  $DC30 RAMcodeDC30_GameState8_World4
CertainlyCode $10000 RAMcode10000_GameState9_Ending
#printf 'for n in range(21):\n for a in(0x6000,0x8000,0x14000,0x99A0,0xC000,0xDC30,0x10000):\n  print("CertainlyCode $%%04X \\"\\" 0 $7" %% (a+3+n*3))\n'
#printf 'for a in(0x6000,0x8000,0x14000,0x99A0,0xC000,0xDC30,0x10000):\n  print("JumpTable $%%04X $%%04X 2 12 \"\"" %% (a+0x42, a+0x43))\n'
CertainlyCode $6003 "" 0 $7
CertainlyCode $8003 "" 0 $7
CertainlyCode $14003 "" 0 $7
CertainlyCode $99A3 "" 0 $7
CertainlyCode $C003 "" 0 $7
CertainlyCode $DC33 "" 0 $7
CertainlyCode $10003 "" 0 $7
CertainlyCode $6006 "" 0 $7
CertainlyCode $8006 "" 0 $7
CertainlyCode $14006 "" 0 $7
CertainlyCode $99A6 "" 0 $7
CertainlyCode $C006 "" 0 $7
CertainlyCode $DC36 "" 0 $7
CertainlyCode $10006 "" 0 $7
CertainlyCode $6009 "" 0 $7
CertainlyCode $8009 "" 0 $7
CertainlyCode $14009 "" 0 $7
CertainlyCode $99A9 "" 0 $7
CertainlyCode $C009 "" 0 $7
CertainlyCode $DC39 "" 0 $7
CertainlyCode $10009 "" 0 $7
CertainlyCode $600C "" 0 $7
CertainlyCode $800C "" 0 $7
CertainlyCode $1400C "" 0 $7
CertainlyCode $99AC "" 0 $7
CertainlyCode $C00C "" 0 $7
CertainlyCode $DC3C "" 0 $7
CertainlyCode $1000C "" 0 $7
CertainlyCode $600F "" 0 $7
CertainlyCode $800F "" 0 $7
CertainlyCode $1400F "" 0 $7
CertainlyCode $99AF "" 0 $7
CertainlyCode $C00F "" 0 $7
CertainlyCode $DC3F "" 0 $7
CertainlyCode $1000F "" 0 $7
CertainlyCode $6012 "" 0 $7
CertainlyCode $8012 "" 0 $7
CertainlyCode $14012 "" 0 $7
CertainlyCode $99B2 "" 0 $7
CertainlyCode $C012 "" 0 $7
CertainlyCode $DC42 "" 0 $7
CertainlyCode $10012 "" 0 $7
CertainlyCode $6015 "" 0 $7
CertainlyCode $8015 "" 0 $7
CertainlyCode $14015 "" 0 $7
CertainlyCode $99B5 "" 0 $7
CertainlyCode $C015 "" 0 $7
CertainlyCode $DC45 "" 0 $7
CertainlyCode $10015 "" 0 $7
CertainlyCode $6018 "" 0 $7
CertainlyCode $8018 "" 0 $7
CertainlyCode $14018 "" 0 $7
CertainlyCode $99B8 "" 0 $7
CertainlyCode $C018 "" 0 $7
CertainlyCode $DC48 "" 0 $7
CertainlyCode $10018 "" 0 $7
CertainlyCode $601B "" 0 $7
CertainlyCode $801B "" 0 $7
CertainlyCode $1401B "" 0 $7
CertainlyCode $99BB "" 0 $7
CertainlyCode $C01B "" 0 $7
CertainlyCode $DC4B "" 0 $7
CertainlyCode $1001B "" 0 $7
CertainlyCode $601E "" 0 $7
CertainlyCode $801E "" 0 $7
CertainlyCode $1401E "" 0 $7
CertainlyCode $99BE "" 0 $7
CertainlyCode $C01E "" 0 $7
CertainlyCode $DC4E "" 0 $7
CertainlyCode $1001E "" 0 $7
CertainlyCode $6021 "" 0 $7
CertainlyCode $8021 "" 0 $7
CertainlyCode $14021 "" 0 $7
CertainlyCode $99C1 "" 0 $7
CertainlyCode $C021 "" 0 $7
CertainlyCode $DC51 "" 0 $7
CertainlyCode $10021 "" 0 $7
CertainlyCode $6024 "" 0 $7
CertainlyCode $8024 "" 0 $7
CertainlyCode $14024 "" 0 $7
CertainlyCode $99C4 "" 0 $7
CertainlyCode $C024 "" 0 $7
CertainlyCode $DC54 "" 0 $7
CertainlyCode $10024 "" 0 $7
CertainlyCode $6027 "" 0 $7
CertainlyCode $8027 "" 0 $7
CertainlyCode $14027 "" 0 $7
CertainlyCode $99C7 "" 0 $7
CertainlyCode $C027 "" 0 $7
CertainlyCode $DC57 "" 0 $7
CertainlyCode $10027 "" 0 $7
CertainlyCode $602A "" 0 $7
CertainlyCode $802A "" 0 $7
CertainlyCode $1402A "" 0 $7
CertainlyCode $99CA "" 0 $7
CertainlyCode $C02A "" 0 $7
CertainlyCode $DC5A "" 0 $7
CertainlyCode $1002A "" 0 $7
CertainlyCode $602D "" 0 $7
CertainlyCode $802D "" 0 $7
CertainlyCode $1402D "" 0 $7
CertainlyCode $99CD "" 0 $7
CertainlyCode $C02D "" 0 $7
CertainlyCode $DC5D "" 0 $7
CertainlyCode $1002D "" 0 $7
CertainlyCode $6030 "" 0 $7
CertainlyCode $8030 "" 0 $7
CertainlyCode $14030 "" 0 $7
CertainlyCode $99D0 "" 0 $7
CertainlyCode $C030 "" 0 $7
CertainlyCode $DC60 "" 0 $7
CertainlyCode $10030 "" 0 $7
CertainlyCode $6033 "" 0 $7
CertainlyCode $8033 "" 0 $7
CertainlyCode $14033 "" 0 $7
CertainlyCode $99D3 "" 0 $7
CertainlyCode $C033 "" 0 $7
CertainlyCode $DC63 "" 0 $7
CertainlyCode $10033 "" 0 $7
CertainlyCode $6036 "" 0 $7
CertainlyCode $8036 "" 0 $7
CertainlyCode $14036 "" 0 $7
CertainlyCode $99D6 "" 0 $7
CertainlyCode $C036 "" 0 $7
CertainlyCode $DC66 "" 0 $7
CertainlyCode $10036 "" 0 $7
CertainlyCode $6039 "" 0 $7
CertainlyCode $8039 "" 0 $7
CertainlyCode $14039 "" 0 $7
CertainlyCode $99D9 "" 0 $7
CertainlyCode $C039 "" 0 $7
CertainlyCode $DC69 "" 0 $7
CertainlyCode $10039 "" 0 $7
CertainlyCode $603C "" 0 $7
CertainlyCode $803C "" 0 $7
CertainlyCode $1403C "" 0 $7
CertainlyCode $99DC "" 0 $7
CertainlyCode $C03C "" 0 $7
CertainlyCode $DC6C "" 0 $7
CertainlyCode $1003C "" 0 $7
CertainlyCode $603F "" 0 $7
CertainlyCode $803F "" 0 $7
CertainlyCode $1403F "" 0 $7
CertainlyCode $99DF "" 0 $7
CertainlyCode $C03F "" 0 $7
CertainlyCode $DC6F "" 0 $7
CertainlyCode $1003F "" 0 $7

DataTable $6042 $6043 2 12 
DataTable $8042 $8043 2 12 
DataTable $C042 $C043 2 12 
DataTable $14042 $14043 2 12 
DataTable $99E2 $99E3 2 12 
DataTable $DC72 $DC73 2 12 
DataTable $10042 $10043 2 10

JumpTable $1C1A9 $1C1AA 2 1   "" 0   1
JumpTable $1C1AC $1C1AD 2 1   "" 0   1
JumpTable $1C1AF $1C1B0 2 1   "" 0   2
JumpTable $1C1B2 $1C1B3 2 1   "" 0   5
JumpTable $1C1B5 $1C1B6 2 1   "" 0   2
JumpTable $1C1B8 $1C1B9 2 1   "" 0   5
JumpTable $1C1BB $1C1BC 2 1   "" 0   3
JumpTable $1C1BE $1C1BF 2 1   "" 0   5
JumpTable $1C1C1 $1C1C2 2 1   "" 0   3
JumpTable $1C1C4 $1C1C5 2 1   "" 0   4

CertainlyCode                $1EE2B JumpWithParams
JumpTableRoutineWithAppendix $1EE2B 

RAM $6031 PasswordEntryBuffer_24_times_6_bit
# ^ 48 bytes are reserved for this
RAM $6061 PasswordByteBuffer_18_times_8_bit
RAM $6062 PasswordByteBuffer_Byte1
RAM $6063 PasswordByteBuffer_Byte2
RAM $6064 PasswordByteBuffer_Byte3
RAM $6065 PasswordByteBuffer_Byte4
RAM $6066 PasswordByteBuffer_Byte5
RAM $6067 PasswordByteBuffer_Byte6
RAM $6068 PasswordByteBuffer_Byte7
RAM $6069 PasswordByteBuffer_Byte8
RAM $606A PasswordByteBuffer_Byte9
RAM $606B PasswordByteBuffer_Byte10
RAM $606C PasswordByteBuffer_Byte11
RAM $606D PasswordByteBuffer_Byte12
RAM $606E PasswordByteBuffer_Byte13
RAM $606F PasswordByteBuffer_Byte14
RAM $6070 PasswordByteBuffer_Byte15
RAM $6071 PasswordByteBuffer_Byte16
RAM $6072 PasswordByteBuffer_Byte17
CertainlyCode $1C98A Password_FillInData
CertainlyCode $6C93  Password_ReadOutData
CertainlyData $1CA50 Password_SymbolToTileIndexMap
CertainlyCode $1C975 Password_CalculateChecksum_18bytes_PlaceInLastByte
CertainlyCode $6C36  Password_VerifyChecksum
CertainlyCode $1C8B1 Password_Clear_6symbols
Comment       $683B  "Clear password entry buffer (48 bytes)"
CertainlyCode $1C960 Password_Render
CertainlyCode $1C8C6 Password_GenerateBase64
CertainlyCode $6BD0  Password_DecodeBase64
CertainlyCode $1C900 Password_SymbolsRotateRightByOneBit
CertainlyCode $6C14  Password_BytesRotateRightByOneBit
CertainlyCode $6C1D  Password_BytesInsert6bits
CertainlyCode $1C909 Password_SymbolsInsertTwoZeros
CertainlyCode $1C922 Password_SymbolsInsert2bits
CertainlyCode $1C91A Password_SymbolsInsert4bits
CertainlyCode $1C912 Password_SymbolsInsert6bits
CertainlyCode $1CAC7
CertainlyCode $1C93A
CertainlyCode $1C8A1 Password_GenerateAndRender
CertainlyCode $6BC6  Password_DecodeAndValidate
CertainlyCode $1C38A Password_MakeDataPacket
CertainlyCode $6109  Password_DecodeDataPacket
CertainlyCode $6947  PasswordUI_Update1char
# Byte0: ($600D & 0xF3) + (($6010 & 0x03) << 2)   Fireball flag, and weapon0 index
# Byte1: ($600E & 0xF3) + (($6011 & 0x03) << 2)   Bow flag,      and weapon1 index
# Byte2: ($600F & 0xF3) + (($6012 & 0x03) << 2)   Crystal flag,  and weapon2 index
# Byte3: $6013                                    TotalScore_byte0
# Byte4: $6014                                    TotalScore_byte1
# Byte5: $6015                                    TotalScore_byte2
# Byte6: $6019                                    Hearts lo
# Byte7: ($601A & 0x0F) + (($601C & 0x0F) << 4)   Hearts hi (maxes out at 3E7 i.e. 0-3), and Credit debt high
# Byte8: $601B                                    Credit debt lo
# Byte9: ($26 & 0xFE) | ($601D & 0x01)            Random, and CreditCardFlag
# Byte10: $601E                                   Number of sledgehammers (0-99)
# Byte11: $601F                                   Number of angel feathers (0-99)
# Byte12: $6020                                   Number of bottles or barrels (0-8, +64 = have barrel)
# Byte13: ($6021 << 4) | ($6026 & 0x0F)           Strength color, player level (0-15 both, but effectively 0-4 both)
# Byte14: ($6022 & 0x03) + (($6023 & 0x03) << 2) + (($6024 & 0x03) << 4)   Treasure flags (0=nope, 1=locked, 2=have)
# Byte15: $6025                                   Number of centurion helpers (0-99)
# Byte16: ($6028 << 4) + ($6029 & 0x07) + (($602A & 0x01) << 3)  Gamestate (0-15), current stage (0-7), 
# Byte17: Checksum
RAM $600D Password_DataPacket_26bytes
# Data packet is decoded as follows:
#   $120..$127 <- 8 bytes from   $6005 + [0x00,0x27,0x4E][$B2]
#                         from   $600D + [0x00,0x27,0x4E][$B2]

# 128, 134 = 3-byte: amount of favor?

#   $13E $157 Flag_FireballPowerup <- byte$00 ($600D)
#   $13F $158 Flag_BowPowerup      <- byte$01 ($600E)
#   $140 $159 Flag_CrystalPowerup  <- byte$02 ($600F)
#   $141 $15A Weapon0_index        <- byte$03 ($6010)                       
#   $142 $15B Weapon1_index        <- byte$04 ($6011) 
#   $143 $15C Weapon2_index        <- byte$05 ($6012)
#   $144 $15D TotalScore_byte0     <- byte$06 ($6013)
#   $145 $15E TotalScore_byte1     <- byte$07 ($6014)
#   $146 $15F TotalScore_byte2     <- byte$08 ($6015)
#   $147 $160                      <- byte$09 ($6016) --unknown purpose
#   $148 $161                      <- byte$0A ($6017) --unknown purpose
#   $149 $162                      <- byte$0B ($6018) --unknown purpose
#   $14A $163 Hearts_byte0         <- byte$0C ($6019)
#   $14B $164 Hearts_byte1         <- byte$0D ($601A)
#   $14C $165 CreditDebt_byte0     <- byte$0E ($601B)
#   $14D $166 CreditDebt_byte1     <- byte$0F ($601C)
#   $14E $167 Flag_CreditCard      <- byte$10 ($601D)
#   $14F $168 SledgeHammers        <- byte$11 ($601E)
#   $150 $169 AngelFeathers        <- byte$12 ($601F)
#   $151 $16A BottlesBarrels       <- byte$13 ($6020)
#   $152 $16B PlayerStrengthColor  <- byte$14 ($6021)
#   $153 $16C Flag_Treasure1       <- byte$15 ($6022)
#   $154 $16D Flag_Treasure2       <- byte$16 ($6023)
#   $155 $16E Flag_Treasure3       <- byte$17 ($6024)
#   $156 $16F Centurion Helpers    <- byte$18 ($6025)
#   $A6 $171 PlayerHP              <- 0x0F             (maxHP is level*8)   -- stored in byte$1A though
#   $AA $170 PlayerLevel           <- byte$19 ($6026)
#   $A0 GameState                  <- byte$1B ($6028)
#   $130 CurrentStage              <- byte$1C ($6029)
JumpTable $14BBF $14BC0 2 2 JumpTable14BBF
CertainlyCode $DE2E GiveStuff_For_FinalMission
CertainlyCode $1EEE5 ResetScreenScrolling
CertainlyCode $1DA69 PlayerHPcheck

CertainlyCode $1C080
CertainlyCode $146BC Unused146BC
CertainlyCode $14BA2 Unused14BA2
CertainlyCode $157F7 Unused157F7
CertainlyCode $1526D Unused1526D
CertainlyCode $14B03 Unused14B03
CertainlyCode $14A43 Unused14A43

CertainlyCode $1DEA2 Unused1DEA2
CertainlyCode $1DEEF Unused1DEEF
CertainlyCode $1DC3D Unused1DC3D
CertainlyCode $1E29B Unused1E29B
CertainlyData $1E441
CertainlyCode $1EC81 Unused1EC81
CertainlyCode $1EE81 Unused1EE81
CertainlyCode $1EF12 Unused1EF12
CertainlyCode $1CD05 Unused1CD05
CertainlyCode $1C4CF Unused1C4CF
CertainlyCode $1C413 Unused1C413
CertainlyCode $1C211 Unused1C211
DataTable $1D59E $1D59F 2 11
CertainlyCode $1005A FinalStageBossAndEndingLogic
CertainlyData $F4BD ScoreBonuses 3
CertainlyData $F4BE ScoreBonuses_byte1
CertainlyData $F4BF ScoreBonuses_byte2
Comment       $F4BD "Contains 0x000064 (100) and 0x001F40 (8000)"
CertainlyData $F4C0 "" 3
Comment       $EEEA "Adds 8000 to score"
Comment       $EE81 "Adds 100 to score"
CertainlyCode $F481 Add100toCurScore
CertainlyCode $F483 Add100_or_8000_toCurScore
#CertainlyCode $EEEA Add8000toCurScore_and_set_ABto80

CertainlyCode $1C000 Unknown1C000 0 7

RAM $C9 FinalStageKilledEnemiesCounter
RAM $1B FinalStageScreenCounter
RAM $14 FinalStageScrollingPositionLo
RAM $15 FinalStageScrollingPositionHi
CertainlyCode $F618 FinalStageScreenScrollRight
Comment $F62A "Not enough enemies killed, loop back to beginning of stage"
RAM $81 FinalStageBossPhase
CertainlyCode $ED50 FinalStageBossLogic
CertainlyCode $ED70 "FinalBossPhase1_FightGoesOn"
CertainlyCode $EDE3 "FinalBossPhase2_MedusaCollapses"
CertainlyCode $EE87 "FinalBossPhase3_ScreenFlashing"
CertainlyCode $EEE0 "FinalBossPhase4_PitFliesToRight_StartEndingIfAtEdge"
Comment $ED90 "$C4 = boss's index in $700 table"
Comment $ED97 "Boss was hit, add 100 points to CurScore"
RAM     $7C5 FinalBossHPlo
RAM     $7C6 FinalBossHPhi
Comment $ED9E "Remove Pit's projectile"
Comment $EDB7 "Subtract boss HP (by amount determined by player's level)"
CertainlyData $1DCD6 PlayerStrengthLevel_damageTable
# levels 00-15: 01,02,03,04, 05,06,06,06
#               A9,0C,85,02, BD,08,07,F0
# However, levels 05,06,07 and 0D,0E,0F are changed into 04 and 0C respectively.
# AND this table is always indexed with StrengthLevel&7.
Comment $EDCB "Final boss is dead"
Comment $EDC9 "Does the boss still have HP left?"
Comment $ED70 "Make sure Pit cannot go to far to the right"

CertainlyCode $F116 FinalStage_PlayerWasHit
Comment $F116 "No hit flag? Ignore hit"
Comment $F11A "Invulnerability frames remain? Ignore hit"
Comment $F11F "Pit in process of dying? Ignore hit"
Comment $F126 "Move him backward by 8 pixels"
Comment $F133 "Give 127 frames of invulnerability"
Comment $F13F "Subtract 300 favor"
Comment $19039 "Subtract 1000 favor"
Comment $1D3B2 "Subtract 100 favor"
Comment $1DA5F "Subtract 300 favor"
Comment $1DA55 "Subtract ($08) favor"
Comment $1843E "A treasure pot was hit!"
Comment $18455 "Subtract 5 hearts, and also 500 favor"
Comment $14889 "Player was hit by an eggplant! Make cursed."
Comment $18446 "Does the player have at least 5 hearts?"
Comment $18452 "Has at least 5 hearts."

CertainlyCode $1D990 Test_IfObjectX_hit
Comment       $1D994 "Test if object at $738 hit the enemy"
Comment       $1D99B "Test if object at $73C hit the enemy"
Comment       $1D9A0 "Test if object at $740 hit the enemy"
Comment       $1D9A5 "Test if object at $744 hit the enemy"
CertainlyCode $1D95C Test_IfObjectX_hit_ByObject_Y
CertainlyCode $1D986 Test_IfObjectX_hit_ByObject_Y_

CertainlyCode $8820 Unused8820
CertainlyCode $F4CE UnusedF4CE
CertainlyCode $A1A2 UnusedA1A2
CertainlyCode $A1F9 UnusedA1F9
CertainlyCode $A224 UnusedA224
CertainlyCode $A75E UnusedA75E
CertainlyCode $A761 UnusedA761
CertainlyCode $A8D1 UnusedA8D1
Comment       $A5E6 "Unreachable code"
CertainlyCode $A5E6
CertainlyCode $C4C8 UnusedC4C8
CertainlyCode $CA50 UnusedCA50
CertainlyCode $CB72 UnusedCB72
CertainlyCode $D1A7 UnusedD1A7
CertainlyCode $D2F7 UnusedD2F7
CertainlyCode $E071 UnusedE071
CertainlyCode $E0E1 UnusedE0E1
CertainlyCode $E1BA UnusedE1BA
CertainlyCode $E350 UnusedE350
CertainlyCode $E601 UnusedE601
CertainlyCode $E48D UnusedE48D
CertainlyCode $E58A UnusedE58A
CertainlyCode $E5FD UnusedE5FD
CertainlyCode $EB95 UnusedEB95
CertainlyCode $EB30 UnusedEB30
CertainlyCode $EB6D UnusedEB6D
CertainlyCode $EC1B UnusedEC1B


CertainlyCode $84F0 Unused84F0
Comment $61DE       "JSR here performs 12 + 341+4 + (X-1)*(341+5) = 346*X + 11 cycles of delay" 
CertainlyCode $61DE Unused61DE_delay346Xplus11
Comment $6C83       "JSR here performs 329224*A+11 cycles of delay"
CertainlyCode $6C83 Unused6C83_delay329224Aplus11
CertainlyCode $664C Unused664C
CertainlyCode $69C8 Unused69C8
CertainlyCode $144AF Unused144AF
CertainlyCode $1446E Unused1446E
CertainlyCode $1223A Unused1223A
CertainlyCode $12253 Unused12253

CertainlyCode $18DE8 PayWithCreditCard
CertainlyCode $18DFA ZeroTheHearts
CertainlyCode $18E03 BlackMarketPurchase_ram0D
CertainlyCode $18E1E BlackMarketPurchase_Powerup
CertainlyCode $18E4C BlackMarketPurchase_7pointsOfHealth
CertainlyCode $18E34 BlackMarketPurchase_Barrel
CertainlyCode $18E56 BlackMarketPurchase_Bottle
CertainlyCode $18E77 BlackMarketPurchase_AngelFeather
CertainlyCode $18E83 BlackMarketPurchase_Torch
CertainlyCode $18E8D BlackMarketPurchase_Pencil
CertainlyCode $18E97 BlackMarketPurchase_failed
CertainlyCode $18E99 BlackMarketPurchase_completed_add_1000favor
CertainlyCode $18EA1 BlackMarketPurchase_completed_add_100favor

CertainlyCode $18A78
CertainlyCode $1E2AD ApproxLog2floor_times2_atleast1
Comment       $1E2AD "1: 0-2"
Comment       $1E2AD "2: 3-4"
Comment       $1E2AD "3: 5-15"
Comment       $1E2AD "4: 16-31"
Comment       $1E2AD "5: 32-63"
Comment       $1E2AD "6: 64-127"
Comment       $1E2AD "7: 128-255"
CertainlyCode $1E2A6 ApproxLog2floor_times2_givezeroifzero
Comment       $1E2A6 "0: 0"
Comment       $1E2A6 "1: 1-2"
Comment       $1E2A6 "2: 3-4"
Comment       $1E2A6 "3: 5-15"
Comment       $1E2A6 "4: 16-31"
Comment       $1E2A6 "5: 32-63"
Comment       $1E2A6 "6: 64-127"
Comment       $1E2A6 "7: 128-255"
CertainlyCode $1E2FA AddToScoreOrFavor_Y_from_10_100_300_500_1000_2000_4000_8000
CertainlyCode $1E2F0 AddToFavor_roughly_60timesA
CertainlyCode $1E2E1 AddToScore_roughly_60timesA
CertainlyCode $1E337 SubtractFavor_roughly_60timesA
Comment $1E33A "Subtract favor by: 10, 100, 300, 500, 1000, 2000, 4000, 8000"

RAM $AD NumberOfContinues_lo
RAM $AE NumberOfContinues_hi
# ^ AE..AF in Japanese version
RAM $B3 EndingRankByte0
RAM $B4 EndingRankByte1
RAM $B5 EndingRankByte2
# ^ B4..B6 in Japanese version
# Limits: 00EA60 (60k) - worst ending
#         013880 (80k) - farmer ending
#         014C08 (85k) - basic guard ending
#         0186A0 (100k) - guard captain ending
# In Western version, this is used instead:
CertainlyCode $10198 CheckEndingCriteria_AtLeast999Hearts
CertainlyCode $101A7 CheckEndingCriteria_AtLeastLevel4
CertainlyCode $101AF CheckEndingCriteria_AtLeastStrength4
CertainlyCode $101B8 CheckEndingCriteria_All3Weapons
CertainlyCode $10189 DetermineWhichEnding
RAM $4B EndingIndex
Comment $F400 "$B3..$B5 <- (PlayerLevel+Strength+2)*10000"
Comment $F400 "$01..$02 = 10000"
Comment $F400 "$03 = PlayerLevel+Strength+2"
Comment $F400 "$04 = 0"
Comment $F400 "$05..$08 = 0x00"
Comment $F415 "$B3..$B5 = $05..$07"
CertainlyCode $F400 Calculate_PlayerLevelStrengthTwo_times_10000_outputB3B4B5
CertainlyCode $F422 Calculate_NumberOfContinues_times_1000_output_050607
Comment $F3E2 "$B3..$B5 <- max(0, $B3..$B5 - $05..$07)"
Comment $F3D9 "Add CurScore to TotalScore."
Comment $F3D9 "$B3..$B5 <- max(0, 10000*(PlayerLevel+Strength+2) - 1000*NumberOfContinues)
CertainlyCode $F3D9 Calculate_JapaneseEndingScore
CertainlyCode $F438 FMA_16bit_by_10000
CertainlyCode $F430 FMA_16bit_by_1000

Comment $159B6 "Is down key held?"
CertainlyCode $18AA0 "Level1_judgeIfGodShouldAppear"
Comment $18AAB "Is Favor ≥ 10000"
Comment $18AC5 "Reached if favor ≥ 10000 and strengthcolor < 4"
Comment $18ACB "Add 1000 to favor"
Comment $1DE41 "Return 10 if A≥5, 5 if A≥3, otherwise 1"
CertainlyCode $1DE41 DetermineHeartSize_1_5_10
CertainlyCode $1DDEC AddToHearts_orDecreaseDebt
CertainlyCode $1DDCC AddToHearts_orDecreaseDebt_AndAddFavorUnlessHeartsMaxedOut
CertainlyCode $1DE5A DecreaseHearts_orIncreaseDebt
CertainlyCode $1DE52 DecreaseHearts_orIncreaseDebt_AndSubtractFavor
Comment $1848E "Does the player have credit card?"
Comment $18493 "No credit card. Does the player have a barrel?"
Comment $184AB "Has credit card. Does the player have a barrel?"
Comment $1849A "No credit card, no barrel."
Comment $1849A "A = $00 | 8 | ($EF & 3)"
Comment $1849A "  = 25% chance for bottle, feather, barrel, credit card each"
Comment $184B2 "Has credit card and barrel."
Comment $184B2 "A = $00 | 8 | ($EF & 1)"
Comment $184B2 "  = 50% chance for bottle or feather"
Comment $184BC "Has credit card, but no barrel."
Comment $184BC "A = $00 | 8 | (($EF & 3)==3 ? 0 : ($EF & 3))"
Comment $184BC "  = 50% chance for bottle, 25% for feather, 25% for barrel"
Comment $184C8 "No credit card, but has barrel."
Comment $184C8 "A = $00 | 8 | (($EF & 3)==2 ? 1 : ($EF & 3))"
Comment $184C8 "  = 50% chance for feather, 25% for bottle, 25% for credit card"
Comment $1846D "Calculate the number of smashed pots"
Comment $18487 "If all pots have been smashed (i.e. this was the last), assign a rare item."
Comment $18487 "$00 <- $701[x] & 0xF0"
Comment $184A2 "$701[x] <- A (treasure number)"
Comment $184A2 "0-3 = large heart"
Comment $184A2 "4   = god of povery"
Comment $184A2 "5-7 = mallet"
Comment $184A2 "8   = bottle"
Comment $184A2 "9   = feather"
Comment $184A2 "10  = barrel"
Comment $184A2 "11  = credit card"
CertainlyCode $183D7 Test_TreasurePotHits_all
CertainlyCode $18423 Test_TreasurePotHit
CertainlyCode $18390 Initialize_TreasurePot
Comment       $183AD "Set X coordinate"
Comment       $183BA "Set Y coordinate"
Comment       $183FF "Is at least one pot still intact?"
Comment       $18452 "Reveal the pot contents"
CertainlyData $183C7 TreasurePotCoordinates
CertainlyCode $184D4 TreasurePotIsOpen
CertainlyCode $18362 TreasurePotRoom_Initialize
Comment $DE11 "Carry is clear"
Comment $ED82 "Carry is set"
Comment $EEF7 "Carry is set"
Comment $EC98 "Carry is set if called from Medusa fight, clear otherwise"
Comment $9A65 "Carry is clear"

CertainlyCode $1937E Unused1937E
CertainlyCode $193A2 Unused193A2
CertainlyCode $19382 Unused19382
CertainlyCode $193D4 Unused193D4
CertainlyData $1939B Times3Table_7elem
CertainlyData $18FE9 Times3Table_7elem_
CertainlyData $18FF0 Times5Table_4elem
CertainlyData $1EA70 PowersOf10table_byte0
CertainlyData $1EA71 PowersOf10table_byte1
CertainlyData $1EA72 PowersOf10table_byte2
CertainlyData $1EA73 "" 3
CertainlyCode $1EA85 Unknown1EA85
CertainlyCode $19388 LoadPowerOf10_into_768_using_X
Comment       $19388 "Sets $768-76A <- 10^(6-X)
CertainlyCode $19385 LoadPowerOf10_into_768_using_766

Comment $18F8D "$04EC <- 1 + min(4,StrengthColor) ≤ min(2,CurrentWorld)"
CertainlyData $1EFBA _data_1EFBA_indexed 5
Comment $1EFBA "With index 5X+Y, this table gives Y<=X"
Comment $1C3E0 "if StrengthColor&7 >= 5, StrengthColor&7 <- 4"

Comment $F422 "$05..$08 <- (NumberOfContinues * 1000)"
Comment $F422 "$01..$02 = 1000"
Comment $F422 "$03 = $AD"
Comment $F422 "$04 = $AE"
Comment $F422 "$05-$08 = 0x00"

CertainlyCode $F4A0 AddCurScore_to_TotalScore

CertainlyCode $F44E FMA_16bit_by_16bit
Comment $F44E "Calculates 16×16->32 bit multiplication"
Comment $F44E "dword[$05..$08] += word[$01..$02] * word[$03..$04]"
CertainlyCode $F443 ResetMultiplyResultToZero

CertainlyCode $12C3C Unused12C3C

Comment $19200 "Set PlayerLevel <- $767. Did it change?"
Comment $19241 "PlayerLevel will be tentatively 0"
Comment $19246 "Copy TotalScore into calctemp"
Comment $19261 "Level <- 1, if $192A3(2) sets carry with $766=2 (10000)"
Comment $1926B "Level <- 2, if $192A3(3) sets carry with $766=2 (10000)"
Comment $19275 "Level <- 3, if $192A3(5) sets carry with $766=2 (10000)"
Comment $1927F "Level <- 4, if $192A3(1) sets carry with $766=1 (100000)"
Comment $1928F "PlayerLevel is set to depending on score: 4:200000 3:100000 2:50000 1:20000 0:otherwise"
Comment $192A3 "Sets carry if calling $193AC A times always gives carry set"
CertainlyCode $193AC Compare3byteInteger
Comment $19251 "$00 <- pointer to calctemp_byte0"

CertainlyData $1C4CA SpecialWeaponMinimumHPtable
Comment $1C486 "If player is level zero, enable/disable powerups"
Comment $1C486 "To enable first weapon, needs 15 hp, 23 for second, 31 for third"
Comment $1C4B5 "Test_HasPowerup"
Comment $1C496 "Disable the powerup, if acquired"
Comment $1C4A8 "Enable the powerup, if acquired"
Comment $1E4C4 "Found enabled and not stolen powerup"
Comment $1E4A1 "Powerup missing or stolen"
CertainlyData $1E565 Table_90_A0_B0

CertainlyCode $12BFC Unused12BFC
CertainlyCode $12C04 Unused12C04
CertainlyCode $12C27 Unused12C27
CertainlyCode $12C2A Unused12C2A
CertainlyCode $12C2D Unused12C2D
CertainlyCode $12C30 Unused12C30
CertainlyCode $12C33 Unused12C33
CertainlyCode $12C36 Unused12C36
CertainlyCode $12C39 Unused12C39


